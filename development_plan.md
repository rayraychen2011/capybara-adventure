# 小鎮生活模擬器 - 開發計劃

## 📋 專案現況分析

### 已完成的基礎架構

- ✅ 基本的三層架構 (GameEngine -> StateManager + SceneManager -> Scenes)
- ✅ 基礎場景系統 (TownScene, ForestScene, LakeScene, HomeScene, InventoryScene)
- ✅ 玩家系統和輸入控制
- ✅ 字體管理系統
- ✅ 基本的狀態管理

### 需要開發的核心系統

#### 🎯 Phase 1: 基礎系統完善 (Week 1)

- [ ] **NPC 系統架構**

  - [ ] NPC 基礎類別設計
  - [ ] 職業系統 (農夫、醫生、護士、槍械店員工等)
  - [ ] 生活軌跡系統
  - [ ] 330 個 NPC 生成與分配

- [ ] **地圖系統擴展**

  - [ ] 30x30 小鎮街道系統
  - [ ] 八個方位城門設計
  - [ ] 森林地圖 (小鎮 8 倍大)
  - [ ] 湖泊地圖 (小鎮 10 倍大)
  - [ ] 沼澤區域

- [ ] **建築系統**
  - [ ] 教堂 (2 座)
  - [ ] 醫院 (5 座)
  - [ ] 槍械店 (10 座)
  - [ ] 便利商店 (15 座)
  - [ ] 路邊小販 (10 個)
  - [ ] 釣魚店 (1 座)
  - [ ] 警察局、電力場、市場

#### 🎯 Phase 2: 核心遊戲系統 (Week 2-3)

- [ ] **釣魚系統**

  - [ ] 釣魚機制 (時間基礎)
  - [ ] 魚類種類系統 (食人魚、石斑魚、鯨魚、企鵝等)
  - [ ] 稀有度系統
  - [ ] 水中危險機制 (1 分鐘食人魚攻擊)

- [ ] **狩獵系統**

  - [ ] 動物 AI 系統
  - [ ] 一般動物 (鹿、羊、野狼、山獅、野豬)
  - [ ] 保育類動物 (穿山甲、石虎、雲豹)
  - [ ] 林地警察執法系統
  - [ ] 法律保護機制

- [ ] **槍械系統**
  - [ ] 槍械種類和屬性
  - [ ] 彈藥系統
  - [ ] 射擊機制
  - [ ] 子彈物理

#### 🎯 Phase 3: 經濟與社會系統 (Week 4)

- [ ] **經濟系統**

  - [ ] 市場交易系統
  - [ ] 稀有度定價算法
  - [ ] 貨幣流通
  - [ ] 商店購買系統

- [ ] **電力系統**

  - [ ] 30 區域劃分
  - [ ] 電力員工分配 (每區 1 人)
  - [ ] 停電機制 (員工住院時)
  - [ ] 電力影響範圍

- [ ] **死亡復活系統**
  - [ ] 醫院重生機制
  - [ ] 警察局背包取回系統 (200 元)
  - [ ] 裝備轉移機制

#### 🎯 Phase 4: 進階功能 (Week 5-6)

- [ ] **載具系統**

  - [ ] 載具種類設計
  - [ ] 道路系統 (車道、土路)
  - [ ] 載具物理和控制

- [ ] **服裝系統**

  - [ ] 服裝種類和外觀變更
  - [ ] 收集和展示系統

- [ ] **任務系統**

  - [ ] 隨機任務生成
  - [ ] 任務完成獎勵
  - [ ] 藏寶探索系統

- [ ] **存檔系統**
  - [ ] 遊戲進度保存
  - [ ] 自動存檔機制
  - [ ] 載入系統

#### 🎯 Phase 5: 世界細節與優化 (Week 7-8)

- [ ] **森林部落系統**

  - [ ] 100 人部落 NPC
  - [ ] 部落生活機制
  - [ ] 與小鎮的互動

- [ ] **NPC 生活細節**

  - [ ] 個人住所分配
  - [ ] 日常作息模擬
  - [ ] 工作崗位空缺機制

- [ ] **遊戲平衡調整**
  - [ ] 經濟平衡
  - [ ] 難度調整
  - [ ] 性能優化

## 🏗️ 技術架構規劃

### 新增系統類別架構

```
src/
  systems/
    npc/              # NPC系統
      npc_manager.py
      npc.py
      profession.py
    economy/          # 經濟系統
      market.py
      shop.py
      currency.py
    environment/      # 環境系統
      weather.py
      power_grid.py
      building.py
    wildlife/         # 野生動物系統
      animal.py
      conservation.py
      hunting.py
    fishing/          # 釣魚系統
      fishing_manager.py
      fish.py
    vehicles/         # 載具系統
      vehicle.py
      road.py
    quest/            # 任務系統
      quest_manager.py
      quest.py
  data/               # 資料定義
    animals.py
    buildings.py
    items.py
    npcs.py
```

### 資料管理策略

- 使用 JSON 檔案儲存 NPC 資料、建築配置
- 使用 SQLite 進行遊戲存檔 (可選)
- 配置檔案分離，便於調整遊戲平衡

### 性能考量

- NPC 系統採用分區更新策略
- 視野範圍外的 NPC 暫停詳細模擬
- 建築物分層渲染
- 大地圖分塊載入

## 🎮 遊戲機制設計重點

### 1. NPC 生活軌跡系統

- 每個 NPC 有固定的日常作息
- 工作時間、休息時間、移動路線
- 受傷住院機制影響工作效率

### 2. 保育動物保護系統

- 智能偵測系統：林地警察 AI
- 違法行為後果：逮捕、罰款
- 生態平衡維護

### 3. 經濟循環系統

- 供需平衡機制
- 稀有物品價格波動
- NPC 消費行為模擬

### 4. 社會結構模擬

- 職業分工明確
- 公共服務依賴 (電力、醫療)
- 社區互動機制

## 📅 開發時程規劃

| 週次     | 主要任務          | 預期成果         |
| -------- | ----------------- | ---------------- |
| Week 1   | NPC 系統+地圖擴展 | 基礎世界框架完成 |
| Week 2-3 | 釣魚+狩獵系統     | 核心玩法可玩     |
| Week 4   | 經濟+電力系統     | 社會系統運作     |
| Week 5-6 | 載具+任務系統     | 遊戲內容豐富     |
| Week 7-8 | 細節+優化         | 完整遊戲體驗     |

## 🎯 里程碑檢查點

### Milestone 1: 基礎世界建成

- [ ] 330 個 NPC 正常生成並分配職業
- [ ] 小鎮 30x30 街道可正常行走
- [ ] 所有建築物正確放置並可互動

### Milestone 2: 核心玩法完成

- [ ] 釣魚系統完整運作，包含稀有魚類
- [ ] 狩獵系統完整，保育動物保護生效
- [ ] 槍械系統可正常使用

### Milestone 3: 社會系統運作

- [ ] 電力系統影響小鎮功能
- [ ] 市場交易系統正常運作
- [ ] 死亡復活機制完整

### Milestone 4: 完整遊戲體驗

- [ ] 所有系統整合無衝突
- [ ] 性能穩定在 60FPS
- [ ] 遊戲平衡良好，有足夠可玩性

---

**注意**: 此計劃將按照程式碼開發風格指南執行，所有程式碼必須包含詳細的繁體中文註解和文檔字串。
